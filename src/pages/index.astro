---
import { getCollection } from "astro:content";
import Head from "../components/head.astro";
import Body from "../components/body.astro";
import Header from "../components/header.astro";
import Footer from "../components/footer.astro";

import { SITE_TITLE, SITE_DESCRIPTION } from "../constants";

const posts = (await getCollection("blog"))
  .filter((post) => {
    return import.meta.env.PROD ? post.data.published : true;
  })
  .sort((a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf());
---

<html lang="es">
  <head>
    <Head title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <Body>
    <Header />
    <main class="container mx-auto p-6">
      {
        posts.length !== 0 && (
          <section class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 sm:gap-36 gap-16 my-20">
            {posts.map((post) => {
              return (
                <a href={post.slug}>
                  <div>
                    <h3>{post.data.title}</h3>
                    <p>{post.data.description}</p>
                  </div>
                </a>
              );
            })}
          </section>
        )
      }
    </main>
    <Footer />
    <script src="../js/main.js"></script>
  </Body>
</html>
